<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkillMatch Pro - Advanced Resume Analyzer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; margin-bottom: 40px; color: white; }
        .header h1 { font-size: 3em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .header p { font-size: 1.2em; opacity: 0.9; }
        .main-content { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; }
        .form-container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .form-container h2 { color: #2c3e50; margin-bottom: 25px; text-align: center; }
        .input-group { margin-bottom: 25px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #34495e; }
        .file-input-container { position: relative; margin-bottom: 15px; }
        .file-input { width: 100%; padding: 15px; border: 2px dashed #bdc3c7; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .file-input:hover { border-color: #3498db; background: #f8f9fa; }
        .file-input input[type="file"] { position: absolute; opacity: 0; width: 100%; height: 100%; cursor: pointer; }
        .input-group textarea { width: 100%; min-height: 150px; padding: 15px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 14px; resize: vertical; transition: border-color 0.3s; }
        .input-group textarea:focus { outline: none; border-color: #3498db; }
        .btn-group { display: flex; gap: 10px; }
        .analyze-btn { flex: 1; background: linear-gradient(45deg, #3498db, #2980b9); color: white; padding: 15px 30px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
        .analyze-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4); }
        .analyze-btn:disabled { background: #bdc3c7; cursor: not-allowed; transform: none; }
        .quality-btn { background: linear-gradient(45deg, #27ae60, #2ecc71); }
        .quality-btn:hover { box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4); }
        .results { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); display: none; }
        .score-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .score-card { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 12px; text-align: center; }
        .score-value { font-size: 2.5em; font-weight: bold; margin-bottom: 5px; }
        .score-label { opacity: 0.9; font-size: 0.9em; }
        .metrics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .metric { background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center; border-left: 4px solid #3498db; }
        .metric-value { font-size: 1.8em; font-weight: bold; color: #2c3e50; margin-bottom: 5px; }
        .metric-label { color: #7f8c8d; font-size: 0.9em; }
        .skills-section { margin-bottom: 30px; }
        .skills-section h3 { color: #2c3e50; margin-bottom: 15px; font-size: 1.3em; }
        .skill-categories { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
        .skill-category { background: #f8f9fa; padding: 20px; border-radius: 10px; }
        .category-title { font-weight: 600; color: #34495e; margin-bottom: 10px; text-transform: capitalize; }
        .skills-list { display: flex; flex-wrap: wrap; gap: 8px; }
        .skill-tag { background: #3498db; color: white; padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; }
        .skill-tag.match { background: #27ae60; }
        .skill-tag.missing { background: #e74c3c; }
        .suggestions { background: linear-gradient(135deg, #ffeaa7, #fdcb6e); padding: 25px; border-radius: 12px; }
        .suggestions h3 { color: #d63031; margin-bottom: 15px; }
        .suggestions ul { color: #2d3436; padding-left: 20px; }
        .suggestions li { margin-bottom: 8px; }
        .loading { text-align: center; color: #7f8c8d; padding: 40px; }
        .tab-container { margin-bottom: 20px; }
        .tabs { display: flex; background: #ecf0f1; border-radius: 8px; padding: 4px; }
        .tab { flex: 1; padding: 12px; text-align: center; cursor: pointer; border-radius: 6px; transition: all 0.3s; }
        .tab.active { background: white; color: #3498db; font-weight: 600; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        @media (max-width: 768px) {
            .main-content { grid-template-columns: 1fr; }
            .header h1 { font-size: 2em; }
            .score-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SkillMatch Pro</h1>
            <p>Advanced AI-Powered Resume Analysis & Job Matching</p>
        </div>

        <div class="main-content">
            <div class="form-container">
                <h2>Resume Analysis</h2>
                
                <div class="tab-container">
                    <div class="tabs">
                        <div class="tab active" onclick="switchTab('extract')">Smart Extract</div>
                        <div class="tab" onclick="switchTab('match')">Job Match</div>
                        <div class="tab" onclick="switchTab('quality')">Quality Check</div>
                        <div class="tab" onclick="switchTab('roles')">Role Prediction</div>
                        <div class="tab" onclick="switchTab('comprehensive')">Full Analysis</div>
                    </div>
                </div>

                <!-- Smart Extract Tab -->
                <div id="extractTab" class="tab-content active">
                    <form id="extractForm" enctype="multipart/form-data">
                        <div class="input-group">
                            <label>Upload Resume (PDF, DOCX, TXT):</label>
                            <div class="file-input-container">
                                <div class="file-input">
                                    <input type="file" name="resume_file" accept=".pdf,.docx,.txt" id="extractResumeFile" required>
                                    <span id="extractFileLabel">Click to upload or drag & drop</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <label for="targetRole">Target Role (Optional):</label>
                            <input type="text" id="targetRole" name="target_role" placeholder="e.g., Software Engineer, Data Scientist..." style="width: 100%; padding: 15px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 14px;">
                        </div>
                        
                        <button type="submit" class="analyze-btn" id="extractBtn" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">🚀 Smart Extract & Analyze</button>
                    </form>
                </div>

                <!-- Job Match Tab -->
                <div id="matchTab" class="tab-content">
                    <form id="analyzeForm" enctype="multipart/form-data">
                        <div class="input-group">
                            <label>Upload Resume (PDF, DOCX, TXT):</label>
                            <div class="file-input-container">
                                <div class="file-input">
                                    <input type="file" name="resume_file" accept=".pdf,.docx,.txt" id="resumeFile">
                                    <span id="fileLabel">Click to upload or drag & drop</span>
                                </div>
                            </div>
                            <label>Or paste resume text:</label>
                            <textarea name="resume_text" placeholder="Paste your resume content here..."></textarea>
                        </div>
                        
                        <div class="input-group">
                            <label for="job">Job Description:</label>
                            <textarea id="job" name="job_description" placeholder="Paste the job description here..." required></textarea>
                        </div>
                        
                        <button type="submit" class="analyze-btn" id="analyzeBtn">Analyze Job Match</button>
                    </form>
                </div>

                <!-- Quality Check Tab -->
                <div id="qualityTab" class="tab-content">
                    <form id="qualityForm" enctype="multipart/form-data">
                        <div class="input-group">
                            <label>Upload Resume (PDF, DOCX, TXT):</label>
                            <div class="file-input-container">
                                <div class="file-input">
                                    <input type="file" name="resume_file" accept=".pdf,.docx,.txt" id="qualityResumeFile">
                                    <span id="qualityFileLabel">Click to upload or drag & drop</span>
                                </div>
                            </div>
                            <label>Or paste resume text:</label>
                            <textarea name="resume_text" placeholder="Paste your resume content here..."></textarea>
                        </div>
                        
                        <button type="submit" class="analyze-btn quality-btn" id="qualityBtn">Analyze Resume Quality</button>
                    </form>
                </div>

                <!-- Role Prediction Tab -->
                <div id="rolesTab" class="tab-content">
                    <form id="rolesForm" enctype="multipart/form-data">
                        <div class="input-group">
                            <label>Upload Resume (PDF, DOCX, TXT):</label>
                            <div class="file-input-container">
                                <div class="file-input">
                                    <input type="file" name="resume_file" accept=".pdf,.docx,.txt" id="rolesResumeFile">
                                    <span id="rolesFileLabel">Click to upload or drag & drop</span>
                                </div>
                            </div>
                            <label>Or paste resume text:</label>
                            <textarea name="resume_text" placeholder="Paste your resume content here..."></textarea>
                        </div>
                        
                        <button type="submit" class="analyze-btn" id="rolesBtn" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">Predict Suitable Roles</button>
                    </form>
                </div>

                <!-- Comprehensive Analysis Tab -->
                <div id="comprehensiveTab" class="tab-content">
                    <form id="comprehensiveForm" enctype="multipart/form-data">
                        <div class="input-group">
                            <label>Upload Resume (PDF, DOCX, TXT):</label>
                            <div class="file-input-container">
                                <div class="file-input">
                                    <input type="file" name="resume_file" accept=".pdf,.docx,.txt" id="comprehensiveResumeFile">
                                    <span id="comprehensiveFileLabel">Click to upload or drag & drop</span>
                                </div>
                            </div>
                            <label>Or paste resume text:</label>
                            <textarea name="resume_text" placeholder="Paste your resume content here..."></textarea>
                        </div>
                        
                        <div class="input-group">
                            <label for="comprehensiveJob">Job Description (Optional):</label>
                            <textarea id="comprehensiveJob" name="job_description" placeholder="Paste job description for complete analysis (optional)..."></textarea>
                        </div>
                        
                        <button type="submit" class="analyze-btn" id="comprehensiveBtn" style="background: linear-gradient(45deg, #e67e22, #d35400);">Complete AI Analysis</button>
                    </form>
                </div>
            </div>

            <div class="results" id="results">
                <!-- Results will be populated here -->
            </div>
        </div>
    </div>

    <script>
        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + 'Tab').classList.add('active');
        }

        // File upload handling
        function setupFileInput(fileInputId, labelId) {
            const fileInput = document.getElementById(fileInputId);
            const label = document.getElementById(labelId);
            
            fileInput.addEventListener('change', function() {
                if (this.files.length > 0) {
                    label.textContent = this.files[0].name;
                } else {
                    label.textContent = 'Click to upload or drag & drop';
                }
            });
        }

        setupFileInput('extractResumeFile', 'extractFileLabel');
        setupFileInput('resumeFile', 'fileLabel');
        setupFileInput('qualityResumeFile', 'qualityFileLabel');
        setupFileInput('rolesResumeFile', 'rolesFileLabel');
        setupFileInput('comprehensiveResumeFile', 'comprehensiveFileLabel');

        // Smart Extract Analysis
        document.getElementById('extractForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('extractBtn');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = '🔍 Extracting & Analyzing...';
            results.style.display = 'none';
            
            try {
                const formData = new FormData(this);
                const response = await fetch('/extract_resume_details', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayExtractResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error extracting resume details: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = '🚀 Smart Extract & Analyze';
            }
        });

        // Job Match Analysis
        document.getElementById('analyzeForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('analyzeBtn');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = 'Analyzing...';
            results.style.display = 'none';
            
            try {
                const formData = new FormData(this);
                const response = await fetch('/analyze', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayMatchResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error analyzing match: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Analyze Job Match';
            }
        });

        // Quality Analysis
        document.getElementById('qualityForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('qualityBtn');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = 'Analyzing...';
            results.style.display = 'none';
            
            try {
                const formData = new FormData(this);
                const response = await fetch('/analyze_quality', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayQualityResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error analyzing quality: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Analyze Resume Quality';
            }
        });

        // Role Prediction Analysis
        document.getElementById('rolesForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('rolesBtn');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = 'Predicting...';
            results.style.display = 'none';
            
            try {
                const formData = new FormData(this);
                const response = await fetch('/predict_roles', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayRoleResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error predicting roles: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Predict Suitable Roles';
            }
        });

        // Comprehensive Analysis
        document.getElementById('comprehensiveForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const btn = document.getElementById('comprehensiveBtn');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            btn.textContent = 'Analyzing...';
            results.style.display = 'none';
            
            try {
                const formData = new FormData(this);
                const response = await fetch('/comprehensive_analysis', {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    displayComprehensiveResults(data);
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Error in comprehensive analysis: ' + error.message);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Complete AI Analysis';
            }
        });

        function displayExtractResults(data) {
            const results = document.getElementById('results');
            
            const personal = data.personal_details;
            const skills = data.extracted_skills;
            const experience = data.experience_details;
            const education = data.education;
            const mlAnalysis = data.ml_analysis;
            const skillRecs = data.skill_recommendations;
            const enhancement = data.resume_enhancement;
            const insights = data.analysis_insights;
            
            results.innerHTML = `
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-value">${mlAnalysis.resume_quality_score}%</div>
                        <div class="score-label">Resume Quality</div>
                    </div>
                    <div class="score-card">
                        <div class="score-value">${insights.profile_completeness}%</div>
                        <div class="score-label">Profile Complete</div>
                    </div>
                    <div class="score-card">
                        <div class="score-value">${skills.length}</div>
                        <div class="score-label">Skills Found</div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>👤 Personal Details</h3>
                    <div class="skill-categories">
                        <div class="skill-category">
                            <div class="category-title">Contact Information</div>
                            <div style="padding: 10px 0;">
                                <p><strong>Name:</strong> ${personal.name}</p>
                                <p><strong>Email:</strong> ${personal.email}</p>
                                <p><strong>Phone:</strong> ${personal.phone}</p>
                                <p><strong>Pronouns:</strong> ${personal.gender_pronoun}</p>
                            </div>
                        </div>
                        <div class="skill-category">
                            <div class="category-title">Experience & Education</div>
                            <div style="padding: 10px 0;">
                                <p><strong>Experience:</strong> ${experience.total_years} years (${insights.experience_level})</p>
                                <p><strong>Companies:</strong> ${experience.companies.join(', ') || 'Not specified'}</p>
                                <p><strong>Degrees:</strong> ${education.degrees.join(', ') || 'Not specified'}</p>
                                <p><strong>Colleges:</strong> ${education.colleges.join(', ') || 'Not specified'}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>🎯 Role Predictions (ML-Based)</h3>
                    <div class="skill-categories" id="mlRolePredictions"></div>
                </div>

                <div class="skills-section">
                    <h3>🔧 Extracted Skills</h3>
                    <div class="skill-category">
                        <div class="category-title">All Skills Found (${skills.length})</div>
                        <div class="skills-list">
                            ${skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                        </div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>📈 Skill Recommendations</h3>
                    <div class="skill-categories" id="skillRecommendations"></div>
                </div>

                <div class="suggestions">
                    <h3>💡 Resume Enhancement Suggestions</h3>
                    <p style="margin-bottom: 15px; font-style: italic;">${enhancement.personalized_message}</p>
                    <ul id="enhancementSuggestions"></ul>
                </div>
            `;

            // Populate ML role predictions
            const mlRolePredictionsDiv = document.getElementById('mlRolePredictions');
            mlAnalysis.predicted_roles.forEach((role, index) => {
                const confidenceColor = role.confidence === 'High' ? '#27ae60' : 
                                      role.confidence === 'Medium' ? '#f39c12' : '#e74c3c';
                
                const roleDiv = document.createElement('div');
                roleDiv.className = 'skill-category';
                roleDiv.innerHTML = `
                    <div class="category-title">
                        ${index + 1}. ${role.role}
                        <span style="float: right; color: ${confidenceColor}; font-size: 0.9em;">
                            ${role.probability}% (${role.confidence})
                        </span>
                    </div>
                    <div style="margin-top: 10px;">
                        <div style="width: ${role.probability}%; height: 8px; background: ${confidenceColor}; border-radius: 4px; margin-bottom: 10px;"></div>
                        <div style="font-size: 0.9em; color: #666;">
                            <strong>Skill Match:</strong> ${role.skill_match_score}%
                            ${role.missing_required_skills.length > 0 ? 
                                `<br><strong>Missing Required:</strong> ${role.missing_required_skills.slice(0, 3).join(', ')}` : ''}
                        </div>
                    </div>
                `;
                mlRolePredictionsDiv.appendChild(roleDiv);
            });

            // Populate skill recommendations
            const skillRecsDiv = document.getElementById('skillRecommendations');
            
            // Immediate skills
            if (skillRecs.immediate_skills.length > 0) {
                const immediateDiv = document.createElement('div');
                immediateDiv.className = 'skill-category';
                immediateDiv.innerHTML = `
                    <div class="category-title">🚀 Immediate Skills to Learn</div>
                    <div class="skills-list">
                        ${skillRecs.immediate_skills.map(skill => `<span class="skill-tag" style="background: #e74c3c;">${skill}</span>`).join('')}
                    </div>
                `;
                skillRecsDiv.appendChild(immediateDiv);
            }

            // Trending skills
            if (skillRecs.trending_skills.length > 0) {
                const trendingDiv = document.createElement('div');
                trendingDiv.className = 'skill-category';
                trendingDiv.innerHTML = `
                    <div class="category-title">📈 Trending Skills</div>
                    <div class="skills-list">
                        ${skillRecs.trending_skills.map(skill => `<span class="skill-tag" style="background: #f39c12;">${skill}</span>`).join('')}
                    </div>
                `;
                skillRecsDiv.appendChild(trendingDiv);
            }

            // Role-specific recommendations (show top 3)
            const topRoleRecs = Object.entries(skillRecs.role_specific_recommendations)
                .filter(([role, rec]) => rec.priority === 'high')
                .slice(0, 3);

            topRoleRecs.forEach(([role, rec]) => {
                const roleRecDiv = document.createElement('div');
                roleRecDiv.className = 'skill-category';
                roleRecDiv.innerHTML = `
                    <div class="category-title">💼 For ${role} Role</div>
                    <div class="skills-list">
                        ${rec.missing_required.map(skill => `<span class="skill-tag missing">${skill}</span>`).join('')}
                        ${rec.missing_preferred.map(skill => `<span class="skill-tag" style="background: #9b59b6;">${skill}</span>`).join('')}
                    </div>
                `;
                skillRecsDiv.appendChild(roleRecDiv);
            });

            // Populate enhancement suggestions
            const enhancementList = document.getElementById('enhancementSuggestions');
            enhancement.suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                enhancementList.appendChild(li);
            });
            
            results.style.display = 'block';
        }

        function displayMatchResults(data) {
            const results = document.getElementById('results');
            
            results.innerHTML = `
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-value">${data.overall_score}%</div>
                        <div class="score-label">Overall Match</div>
                    </div>
                    <div class="score-card">
                        <div class="score-value">${data.resume_quality}%</div>
                        <div class="score-label">Resume Quality</div>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-value">${data.text_similarity}%</div>
                        <div class="metric-label">Text Similarity</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.skill_match}%</div>
                        <div class="metric-label">Skill Match</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.experience_match}%</div>
                        <div class="metric-label">Experience Match</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.resume_experience}</div>
                        <div class="metric-label">Years Experience</div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>Skill Analysis by Category</h3>
                    <div class="skill-categories" id="skillCategories"></div>
                </div>

                <div class="suggestions">
                    <h3>💡 Improvement Suggestions</h3>
                    <ul id="suggestionsList"></ul>
                </div>
            `;

            // Populate skill categories
            const skillCategoriesDiv = document.getElementById('skillCategories');
            for (const [category, skills] of Object.entries(data.skill_matches)) {
                const gaps = data.skill_gaps[category] || [];
                
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'skill-category';
                categoryDiv.innerHTML = `
                    <div class="category-title">${category.replace('_', ' ')}</div>
                    <div class="skills-list">
                        ${skills.map(skill => `<span class="skill-tag match">${skill}</span>`).join('')}
                        ${gaps.map(skill => `<span class="skill-tag missing">${skill}</span>`).join('')}
                    </div>
                `;
                skillCategoriesDiv.appendChild(categoryDiv);
            }

            // Populate suggestions
            const suggestionsList = document.getElementById('suggestionsList');
            data.suggestions.forEach(suggestion => {
                const li = document.createElement('li');
                li.textContent = suggestion;
                suggestionsList.appendChild(li);
            });
            
            results.style.display = 'block';
        }

        function displayQualityResults(data) {
            const results = document.getElementById('results');
            
            results.innerHTML = `
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-value">${data.quality_score}%</div>
                        <div class="score-label">Resume Quality</div>
                    </div>
                </div>

                <div class="metrics-grid">
                    <div class="metric">
                        <div class="metric-value">${data.word_count}</div>
                        <div class="metric-label">Word Count</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.experience_years}</div>
                        <div class="metric-label">Years Experience</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.education_score}</div>
                        <div class="metric-label">Education Score</div>
                    </div>
                    <div class="metric">
                        <div class="metric-value">${data.project_score}</div>
                        <div class="metric-label">Project Score</div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>Skills Breakdown</h3>
                    <div class="skill-categories" id="skillBreakdown"></div>
                </div>
            `;

            // Populate skill breakdown
            const skillBreakdownDiv = document.getElementById('skillBreakdown');
            for (const [category, info] of Object.entries(data.skill_breakdown)) {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'skill-category';
                categoryDiv.innerHTML = `
                    <div class="category-title">${category.replace('_', ' ')} (${info.count})</div>
                    <div class="skills-list">
                        ${info.skills.map(skill => `<span class="skill-tag">${skill}</span>`).join('')}
                    </div>
                `;
                skillBreakdownDiv.appendChild(categoryDiv);
            }
            
            results.style.display = 'block';
        }

        function displayRoleResults(data) {
            const results = document.getElementById('results');
            
            results.innerHTML = `
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-value">${data.total_predictions}</div>
                        <div class="score-label">Role Predictions</div>
                    </div>
                </div>

                <div class="skills-section">
                    <h3>🎯 Predicted Suitable Roles</h3>
                    <div class="skill-categories" id="rolePredictions"></div>
                </div>

                <div class="suggestions">
                    <h3>💼 Career Guidance</h3>
                    <ul>
                        <li>Focus on high-confidence roles for immediate opportunities</li>
                        <li>Develop skills for medium-confidence roles to expand options</li>
                        <li>Consider the probability scores when prioritizing applications</li>
                    </ul>
                </div>
            `;

            // Populate role predictions
            const rolePredictionsDiv = document.getElementById('rolePredictions');
            data.role_predictions.forEach((role, index) => {
                const confidenceColor = role.confidence === 'High' ? '#27ae60' : 
                                      role.confidence === 'Medium' ? '#f39c12' : '#e74c3c';
                
                const roleDiv = document.createElement('div');
                roleDiv.className = 'skill-category';
                roleDiv.innerHTML = `
                    <div class="category-title">
                        ${index + 1}. ${role.role}
                        <span style="float: right; color: ${confidenceColor}; font-size: 0.9em;">
                            ${role.probability}% (${role.confidence})
                        </span>
                    </div>
                    <div style="margin-top: 10px; padding: 10px; background: #ecf0f1; border-radius: 5px;">
                        <div style="width: ${role.probability}%; height: 8px; background: ${confidenceColor}; border-radius: 4px;"></div>
                    </div>
                `;
                rolePredictionsDiv.appendChild(roleDiv);
            });
            
            results.style.display = 'block';
        }

        function displayComprehensiveResults(data) {
            const results = document.getElementById('results');
            
            const quality = data.quality_assessment || {};
            const roles = data.role_predictions || [];
            const jobMatch = data.job_matching || null;
            
            let html = `
                <div class="score-grid">
                    <div class="score-card">
                        <div class="score-value">${quality.quality_score || 0}%</div>
                        <div class="score-label">Resume Quality</div>
                    </div>
            `;
            
            if (jobMatch) {
                html += `
                    <div class="score-card">
                        <div class="score-value">${jobMatch.overall_score}%</div>
                        <div class="score-label">Job Match</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            
            if (jobMatch) {
                html += `
                    <div class="metrics-grid">
                        <div class="metric">
                            <div class="metric-value">${jobMatch.text_similarity}%</div>
                            <div class="metric-label">Text Similarity</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${jobMatch.skill_match}%</div>
                            <div class="metric-label">Skill Match</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value">${jobMatch.experience_match}%</div>
                            <div class="metric-label">Experience Match</div>
                        </div>
                    </div>
                `;
            }
            
            html += `
                <div class="skills-section">
                    <h3>🎯 Top Predicted Roles</h3>
                    <div class="skill-categories" id="topRoles"></div>
                </div>
            `;
            
            if (jobMatch && jobMatch.skill_matches) {
                html += `
                    <div class="skills-section">
                        <h3>🔍 Skill Analysis</h3>
                        <div class="skill-categories" id="comprehensiveSkills"></div>
                    </div>
                `;
            }
            
            html += `
                <div class="suggestions">
                    <h3>🚀 AI-Powered Recommendations</h3>
                    <ul id="comprehensiveSuggestions">
                        <li>Complete analysis performed using advanced AI algorithms</li>
                        <li>Recommendations based on role predictions and quality assessment</li>
                        <li>Focus on developing skills for your target roles</li>
                    </ul>
                </div>
            `;
            
            results.innerHTML = html;
            
            // Populate top roles
            const topRolesDiv = document.getElementById('topRoles');
            roles.slice(0, 5).forEach((role, index) => {
                const confidenceColor = role.confidence === 'High' ? '#27ae60' : 
                                      role.confidence === 'Medium' ? '#f39c12' : '#e74c3c';
                
                const roleDiv = document.createElement('div');
                roleDiv.className = 'skill-category';
                roleDiv.innerHTML = `
                    <div class="category-title">
                        ${index + 1}. ${role.role}
                        <span style="float: right; color: ${confidenceColor};">
                            ${role.probability}%
                        </span>
                    </div>
                `;
                topRolesDiv.appendChild(roleDiv);
            });
            
            // Populate skill analysis if job matching was performed
            if (jobMatch && jobMatch.skill_matches) {
                const comprehensiveSkillsDiv = document.getElementById('comprehensiveSkills');
                for (const [category, skills] of Object.entries(jobMatch.skill_matches)) {
                    const gaps = jobMatch.skill_gaps[category] || [];
                    
                    if (skills.length > 0 || gaps.length > 0) {
                        const categoryDiv = document.createElement('div');
                        categoryDiv.className = 'skill-category';
                        categoryDiv.innerHTML = `
                            <div class="category-title">${category.replace('_', ' ')}</div>
                            <div class="skills-list">
                                ${skills.map(skill => `<span class="skill-tag match">✓ ${skill}</span>`).join('')}
                                ${gaps.map(skill => `<span class="skill-tag missing">✗ ${skill}</span>`).join('')}
                            </div>
                        `;
                        comprehensiveSkillsDiv.appendChild(categoryDiv);
                    }
                }
            }
            
            results.style.display = 'block';
        }
    </script>
</body>
</html>